<app-auth-shell
  title="Create your account"
  subtitle="Start organizing events in minutes"
  footerText="Already have an account?"
  footerLinkLabel="Sign in"
  footerLink="/login"
>
  <app-auth-providers dividerText="or sign up with email" />

  <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="auth-form">
    @if (submitError()) {
      <div class="auth-server-error" role="alert" aria-live="polite">
        {{ submitError() }}
      </div>
    }

    <app-auth-text-field
      id="fullName"
      label="Full name"
      autocomplete="name"
      [control]="registerForm.controls.fullName"
      requiredMessage="Full name is required"
      minLengthMessage="Name must be at least 2 characters"
    />

    <app-auth-text-field
      id="email"
      label="Email address"
      type="email"
      autocomplete="email"
      [control]="registerForm.controls.email"
      requiredMessage="Email is required"
      emailMessage="Please enter a valid email"
    />

    <app-auth-password-field
      id="password"
      label="Password"
      autocomplete="new-password"
      [control]="registerForm.controls.password"
      requiredMessage="Password is required"
      minLengthMessage="Password must be at least 8 characters"
      [feedback]="true"
    />

    <app-auth-password-field
      id="confirmPassword"
      label="Confirm password"
      autocomplete="new-password"
      [control]="registerForm.controls.confirmPassword"
      requiredMessage="Please confirm your password"
      [feedback]="false"
      [customErrorMessage]="
        registerForm.errors?.['passwordMismatch'] ? 'Passwords do not match' : null
      "
    />

    <!-- Terms -->
    <div class="auth-terms">
      <p-checkbox formControlName="terms" [binary]="true" inputId="terms" />
      <label for="terms" class="auth-terms-label">
        I agree to the <a routerLink="/">Terms of Service</a> and
        <a routerLink="/">Privacy Policy</a>
      </label>
    </div>
    @if (registerForm.controls.terms.touched && registerForm.controls.terms.errors) {
      <small class="auth-error">You must accept the terms to continue</small>
    }

    <p-button
      type="submit"
      label="Create account"
      [rounded]="true"
      styleClass="w-full"
      [loading]="isSubmitting()"
      [disabled]="isSubmitting()"
    />
  </form>
</app-auth-shell>
